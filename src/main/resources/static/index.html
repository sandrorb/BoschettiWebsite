<!doctype html>
<html lang="en">
  <head>
    <!-- <meta charset="utf-8"> -->
    <meta charset="iso-8859-1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Projeto Spring Boot Eclipse</title>
    
    <link rel="icon" type="imagem/png" href="aperto-de-mao.png" />
    
    <!-- Importação do JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    
    <!-- Importação do Bootstrap além da que está mais ao fim do documento -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

    <style>
    	body {text-align: center; color: #F2F3F4; background-color: #283747; font-family:"Calibri";}
    	a {color: #85C1E9;}
    	#meuTexto {font-size: 20pt; padding: 5px;}
    	#data {font-size: 12pt; padding: 5px;}
    	#corpo {margin: auto; margin-top: 5%;
    	        background-color: #1F618D; width: 80%; border-radius: 10px;
    	        padding: 20px;
    	        }
    	#meuBotao {margin-top: 10px; margin-bottom: 10px;}
    	#textoCliqueBotao {color: gray; font-size: 14pt; padding: 5px;}
    	#textoExplicacao {font-size: 14pt; padding: 5px;}
    	#assinatura {color: #F39C12}
    </style>
    
  </head>
  
  <body onload=data()>
  
  	<div id="corpo">
    	<h2>Futuro Projeto Java</h2>
    	<div id="data"></div>
		<div id="meuTexto"></div>
		<div id="meuBotao">
			<button type="button" class="btn btn-light" onclick="cliquedebotao()">Exemplo Chamada Ajax</button>
		</div>
		<div id="textoCliqueBotao"></div>
		<hr>
		<div id="textoExplicacao">
			Este é um projeto sendo implementado com a finalidade de aprendidado
			e de ser apresentado como portifólio. Utiliza ferramentas tais como Eclipse,
		    Spring Boot, Bootstrap, Jquery e Heroku (hospedagem gratuita) e
		    Github (ferramenta de versionamento e repositório de código fonte). <br>
		    Vide código em
		    <a href="https://github.com/sandrorb/testewebsrb"  target="_blank">
		    https://github.com/sandrorb/testewebsrb</a> <br>
		    Será incorporado em breve JPA/Hibernate, PostgresSQL, MVC etc.
		</div>
		<div id="assinatura">Por Sandro Roger Boschetti</div>
	</div>
		
	<form>
	  <br>
	  <input type="text" id="parkingSpotNumber" name="parkingSpotNumber" value="205B"><br>
	  <input type="text" id="licensePlateCar" name="licensePlateCar" value="RRS8562"><br>
	  <input type="text" id="brandCar" name="brandCar" value="audi"><br>
	  <input type="text" id="modelCar" name="modelCar" value="q5"><br>
	  <input type="text" id="colorCar" name="colorCar" value="black"><br>
	  <input type="text" id="responsibleName" name="responsibleName" value="Carlos Daniel"><br>
	  <input type="text" id="apartment" name="apartment" value="205"><br>
	  <input type="text" id="block" name="block" value="B"><br><br>
	</form>
 	<!--<input value="Botão Submit" type="button" onclick="sendJsonData()">-->
	<button type="button" class="btn btn-light" onclick="sendJsonData2()">Enviar Dados Json</button> <br>

	<script type="text/javascript">
	
	function sendJsonData2(){             
        var parkingSpotNumber = $("#parkingSpotNumber").val();
        var licensePlateCar = $("#licensePlateCar").val();
        var brandCar = $("#brandCar").val();
        var modelCar = $("#modelCar").val();
        var colorCar = $("#colorCar").val();
        var responsibleName = $("#responsibleName").val();
        var apartment = $("#apartment").val();
        var block = $("#block").val();
        
        $.ajax({
        	method: "POST",
        	url: "/parking-spot",
        	data: JSON.stringify({
        		parkingSpotNumber : parkingSpotNumber,
        		licensePlateCar : licensePlateCar,
        		brandCar : brandCar,
        		modelCar : modelCar,
        		colorCar : colorCar,
        		responsibleName : responsibleName,
        		apartment : apartment,
        		block : block}),
        	contentType: "application/json; charset=utf-8",
        	success: function(response){
        		/* alert("Executado!"); */
        	}
        }).fail(function(xhr, status, errorThrown){
        	alert("Erro ao salvar dados: " + xhr.responseText);
        });
	}     
        
	
	</script>


	<!-- Importação do Bootstrap além da que está no head -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>

	<script>
		function cliquedebotao(){
	/* 		document.getElementById("meuTexto").innerHTML = "Hello World";
			$("#meuTexto").text("Boschetti"); */
			$.get( "/welcome", function( data ) {
				  $("#meuTexto").text(data);
				});
		}
		function data(){
		    var now = new Date(),
	        dia  = now.getDate().toString(),
	        diaF = (dia.length == 1) ? '0'+dia : dia,
	        mes  = (now.getMonth()+1).toString(), //+1 pois no getMonth Janeiro começa com zero.
	        mesF = (mes.length == 1) ? '0'+mes : mes,
	        anoF = now.getFullYear();
		    hora = now.getHours().toString();
		    horaF = (hora.length == 1) ? '0'+hora : hora;
		    min = now.getMinutes().toString();
		    minF = (min.length == 1) ? '0'+min : min;
			$("#data").text(diaF + "/" + mesF + "/" + anoF + " " + horaF + ":" + minF);
		}
		
				
		  
		function sendJsonData(){             
		        var parkingSpotNumber = document.querySelector('#parkingSpotNumber').value;
		        var licensePlateCar = document.querySelector('#licensePlateCar').value;
		        var brandCar = document.querySelector('#brandCar').value;
		        var modelCar = document.querySelector('#modelCar').value;
		        var colorCar = document.querySelector('#colorCar').value;
		        var responsibleName = document.querySelector('#responsibleName').value;
		        var apartment = document.querySelector('#apartment').value;
		        var block = document.querySelector('#block').value;
		        
		        var formData = new FormData();
		        formData.append("parkingSpotNumber", JSON.stringify(parkingSpotNumber));
		        formData.append("licensePlateCar", JSON.stringify(licensePlateCar));
		        formData.append("brandCar", JSON.stringify(brandCar));
		        formData.append("modelCar", JSON.stringify(modelCar));
		        formData.append("colorCar", JSON.stringify(colorCar));
		        formData.append("responsibleName", JSON.stringify(responsibleName));
		        formData.append("apartment", JSON.stringify(apartment));
		        formData.append("block", JSON.stringify(block));     

		        fetch('http://localhost:8080/parking-spot', {
		            method: 'POST',
		            body: formData
		        })
		        .then(response => {
		            if(!response.ok)
		                throw new Error("não foi possível completar cadastro");

		            return response.text();
		        })
		        .then(data => alert(data));
		 }
	</script>

  </body>
</html>